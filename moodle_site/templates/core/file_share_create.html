{% extends "base.html" %}

{% block title %}Create Share Link | Moodle Lite{% endblock %}

{% block content %}
<div class="dashboard-wrapper">
  <main class="dashboard">
    <section class="panel">
      <h1 style="margin-bottom: 2rem;">Create Share Link</h1>
      <p style="margin-bottom: 2rem; color: #666;">Share "{{ file.name }}" with others via a secure link.</p>

      {% if messages %}
        {% for message in messages %}
          <div class="alert alert-{{ message.tags }}" style="margin-bottom: 1rem; padding: 1rem; border-radius: 8px; background: {% if message.tags == 'error' %}#fee;{% elif message.tags == 'success' %}#efe;{% else %}#eef;{% endif %}">
            {{ message }}
          </div>
        {% endfor %}
      {% endif %}

      <form method="post" style="max-width: 600px;">
        {% csrf_token %}

        <h3 style="margin-bottom: 1rem;">Permission Levels</h3>

        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">View Permission</label>
          {{ form.view_permission_level }}
          <p style="color: #666; font-size: 0.875rem; margin-top: 0.25rem;">{{ form.view_permission_level.help_text }}</p>
        </div>

        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Edit Permission</label>
          {{ form.edit_permission_level }}
          <p style="color: #666; font-size: 0.875rem; margin-top: 0.25rem;">{{ form.edit_permission_level.help_text }}</p>
        </div>

        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Download Permission</label>
          {{ form.download_permission_level }}
          <p style="color: #666; font-size: 0.875rem; margin-top: 0.25rem;">{{ form.download_permission_level.help_text }}</p>
        </div>

        <h3 style="margin: 2rem 0 1rem;">Optional Settings</h3>

        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Password (optional)</label>
          {{ form.password }}
          <p style="color: #666; font-size: 0.875rem; margin-top: 0.25rem;">{{ form.password.help_text }}</p>
        </div>

        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Confirm Password</label>
          {{ form.password_confirm }}
        </div>

        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Expiration (days)</label>
          {{ form.expiration_days }}
          <p style="color: #666; font-size: 0.875rem; margin-top: 0.25rem;">{{ form.expiration_days.help_text }}</p>
        </div>

        {% if form.non_field_errors %}
          <div style="color: red; margin-bottom: 1rem;">{{ form.non_field_errors }}</div>
        {% endif %}

        <div style="display: flex; gap: 1rem;">
          <button type="submit" class="btn btn-primary">Create Share Link</button>
          <a href="{% url 'core:file_detail' file.id %}" class="btn btn-secondary">Cancel</a>
        </div>
      </form>
    </section>
  </main>
</div>
{% endblock %}
